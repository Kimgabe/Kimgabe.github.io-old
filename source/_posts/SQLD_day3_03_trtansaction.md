---
title: "[SQLD] 3일차 : 모델이 표현하는 트랜잭션의 이해"
cover: "https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=1920&h=1080&fit=crop"
date: 2024-04-26
categories:
  - [personal-study, sql]
tags: []
toc: true
---
## 🚦 Summary
- 데이터베이스에서 트랜잭션의 개념과 특징을 설명
- ACID 특성을 통해 트랜잭션의 원자성, 일관성, 격리성, 지속성에 대해 소개
- 데이터 모델을 통해 트랜잭션이 어떻게 처리되는지 예시와 함께 설명

---


## 📌 Intro.
- 이번 포스팅에서는 데이터베이스에서 트랜잭션의 개념과 특징에 대해 알아보겠습니다.
- 트랜잭션의 ACID 특성인 원자성, 일관성, 격리성, 지속성에 대해 배울 수 있습니다.
- 또한, 데이터 모델을 통해 트랜잭션이 어떻게 처리되는지 예시와 함께 살펴보겠습니다.

---


## 과목범위
![](https://i.imgur.com/OINUEKe.png)



# 트랜잭션이란?!

> 트랜잭션은 데이터베이스에서 하나의 논리적인 작업 단위를 말합니다.

- 트랜잭션은 여러 연산을 포함할 수 있지만 모든 연산이 함께 성공하거나 실패해야 한다는 특징이 있습니다.
- 트랜잭션의 주요 특징은 원자성, 일관성, 격리성, 지속성을 가지며, 이를 ACID 특성이라고 합니다.


💡ACID 특성이란?!


1. 원자성 (Atomicity)
    - 원자성은 트랜잭션이 데이터베이스에 대한 모든 작업을 완전히 완료하거나 전혀 수행하지 않아야 한다는 원칙을 말합니다. 즉, 하나의 트랜잭션 내에서 실행된 모든 명령은 모두 성공하거나, 하나라도 실패할 경우 전체 트랜잭션이 취소되어야 합니다.
      
2. 일관성 (Consistency)
    - 일관성은 트랜잭션이 실행되기 전과 후에 데이터베이스가 일관된 상태를 유지해야 한다는 원칙입니다. 모든 트랜잭션은 데이터베이스의 모든 규칙을 준수하여 실행되어야 하며, 트랜잭션이 완료된 후에는 데이터베이스가 여전히 유효한 상태여야 합니다.
      
3. 격리성 (Isolation)
    - 격리성은 동시에 여러 트랜잭션이 실행될 때, 각 트랜잭션이 다른 트랜잭션의 중간 실행 결과에 영향을 받지 않도록 보장하는 원칙입니다. 이는 트랜잭션이 서로 간섭 없이 독립적으로 실행되어야 함을 의미하며, 격리 수준에 따라 다양한 동시성 문제를 방지할 수 있습니다.
      
4. 지속성 (Durability)
    - 지속성은 트랜잭션이 성공적으로 완료된 후에 그 결과가 영구적으로 저장되어야 함을 의미합니다. 시스템에 장애가 발생하더라도, 완료된 트랜잭션의 결과는 데이터베이스에 안전하게 저장되어야 하며, 이는 데이터의 손실을 방지합니다.



 

![](https://i.imgur.com/OexDprW.png)

- 위 이미지는 트랜잭션을 계좌이체를 예시로 표현한 것 입니다.
- A계좌에서 돈을 출금하고 B계좌에 돈을 입금하는 두 작업은 한 세트로 이루어져야 하며, 둘 중 하나만 실행되는 것은 허용되지 않습니다. 
- 이렇게 두 작업을 묶어서 트랜잭션이라고 부르며, 두 작업은 모두 성공하거나, 하나라도 실패할 경우 모두 취소되어야 합니다.
- 참고로 이미지속 코드는 A계좌에서 금액을 빼는 동작과 B계좌에 금액을 더하는 동작을 포함하고 있으며, `commit()` 함수를 통해 이 모든 작업을 데이터베이스에 반영하려고 할 때 사용됩니다.


##  트랜잭션과 데이터 모델
- 트랜잭션을 좀 더 간단하게 표현하자면 "데이터베이스의 논리적 연산 단위" 라 할 수 있습니다.
- 아래의 데이터 모델을 사용해 트랜잭션이 무엇인지, 어떻게 처리가 되는지를 살펴보겠습니다.

![](https://i.imgur.com/76Ld1Q1.png)

- 위 이미지는 주문과 주문상세라는 두 테이블 간의 관계를 트랜잭션의 관점에서 설명하고 있습니다.
- 주문 Entity와 주문상세 Entity는 하나의 주문에 대해 여러 주문상세 정보가 있을 수 있는 관계로, 이 두 정보는 한 트랜잭션 내에서 처리되어야 하며, 이를 **'필수 관계'** 라고 합니다.
- 주문이 존재하지 않으면 주문상세도 존재할 수 없으며, 주문과 주문상세는 서로 의존적인 관계에 있습니다. 이는 데이터베이스 설계 시 두 테이블 간의 무결성을 보장하는 제약조건으로 표현됩니다.
- 이미지에 나와 있는 코드는 주문 API를 통해 주문 데이터를 먼저 입력하고, 그 다음 주문상세 API를 통해 주문상세 데이터를 입력하는 과정을 보여줍니다. 
- 이때 모든 작업은 하나의 트랜잭션 안에서 처리되어야 하며, 이는 두 API 호출 사이에 데이터베이스 commit 이 일어나지 않음을 의미합니다. 모든 데이터가 성공적으로 입력되면 최종적으로 commit을 통해 데이터베이스에 반영됩니다.

---


## 🎈 Outro.
- 트랜잭션은 데이터베이스에서 하나의 논리적인 작업 단위로, 모든 연산이 함께 성공하거나 실패해야 합니다.
- ACID 특성을 통해 트랜잭션의 원자성, 일관성, 격리성, 지속성을 보장함으로써 데이터의 무결성을 유지할 수 있습니다.
- 데이터 모델을 통해 트랜잭션이 어떻게 처리되는지 이해하는 것은 효과적인 데이터베이스 설계와 관리에 중요합니다.
- 트랜잭션의 개념과 특징을 숙지하고, 데이터 모델링 시 트랜잭션 처리를 고려하는 것이 좋습니다.

