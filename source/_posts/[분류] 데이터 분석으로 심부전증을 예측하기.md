---
title: "[ë¶„ë¥˜] ë°ì´í„° ë¶„ì„ìœ¼ë¡œ ì‹¬ë¶€ì „ì¦ì„ ì˜ˆì¸¡í•˜ê¸°"
cover: "https://images.unsplash.com/photo-1526379095098-d400fd0bf935?w=1920&h=1080&fit=crop"
date: 2025-07-18
categories:
  - [portfolio]
tags: []
toc: true
---
ğŸ“Œì˜ë£Œì§€í‘œ ë°ì´í„°ë¥¼ í†µí•´ ì‹¬ë¶€ì „ì¦ ì§„ë‹¨í•˜ê¸°(Kaggle ë°ì´í„° í™œìš©)

# ì™œ ì‹¬ë¶€ì „ì¦ ë°ì´í„°ë¥¼ ê³¨ëëŠ”ê°€? ì— ëŒ€í•˜ì—¬ 
- ë¶€íŠ¸ìº í”„ì—ì„œ ì²˜ìŒìœ¼ë¡œ ë¹…ë°ì´í„° ë¶„ì„ì„ ë°°ìš°ë©° ë§ˆì§€ë§‰ì— ë”¥ëŸ¬ë‹ì— ëŒ€í•´ ë°°ìš°ëŠ” ê³¼ì •ì´ ìˆì—ˆë‹¤.
- ì´ë•Œ, ì´ë¯¸ì§€ë¥¼ í†µí•´ íì§ˆí™˜ ë“±ì„ ë¶„ë¥˜í•´ëŠ” ëª¨ë¸ë§ì— ëŒ€í•œ ì‚¬ë¡€ë¥¼ ë°°ì› ëŠ”ë° ì´ë•Œ ìƒê¸´ ê¶ê¸ˆì¦ì´ ìˆì—ˆë‹¤.
- "ì´ë¯¸ì§€ë¡œ ë¶„ë¥˜í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì˜ë£Œê´€ë ¨ ë‹¤ì–‘í•œ ì§€í‘œ ë°ì´í„°ë“¤ì„ í™œìš©í•´ ë¨¸ì‹ ëŸ¬ë‹ìœ¼ë¡œ ì§ˆë³‘ì„ ì˜ˆì¸¡/ë¶„ë¥˜ í• ìˆ˜ëŠ” ì—†ëŠ” ê±¸ê¹Œ?"
- ë•Œë§ˆì¹¨ kaggleì—ì„œ ì‹¬ë¶€ì „ì¦í™˜ìë¥¼ ì˜ˆì¸¡í•˜ëŠ”ë° í™œìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ë°œê²¬í•´ì„œ ì´ë¥¼ í†µí•´ í™•ì¸í•´ë³´ê³ ì í•œë‹¤.
---





# ì£¼ì œ : ì˜ˆì¸¡ ëª¨ë¸ë¡œ ì‹¬ë¶€ì „ì¦ ì—¬ë¶€ ì˜ˆì¸¡í•˜ê¸°

----------


## ë°ì´í„° ì†Œê°œ

**Kaggleì˜ Heart Failure Prediction ë°ì´í„°ì…‹ì„ ì‚¬ìš©**

---


### **ì»¬ëŸ¼ì„¤ëª…**

1. ë²”ì£¼í˜• ë°ì´í„°
- anaemia: í™˜ìì˜ ë¹ˆí˜ˆì¦ ì—¬ë¶€ (0: ì •ìƒ, 1: ë¹ˆí˜ˆ)
- diabetes: ë‹¹ë‡¨ë³‘ ì—¬ë¶€ (0: ì •ìƒ, 1: ë‹¹ë‡¨)
- high_blood_pressure: ê³ í˜ˆì•• ì—¬ë¶€ (0: ì •ìƒ, 1: ê³ í˜ˆì••)
- sex: ì„±ë³„ (0: ì—¬ì„±, 1: ë‚¨ì„±)
- smoking: í¡ì—° ì—¬ë¶€ (0: ë¹„í¡ì—°, 1: í¡ì—°)
- DEATH_EVENT: ì‚¬ë§ ì—¬ë¶€ (0: ìƒì¡´, 1: ì‚¬ë§)

---




2. ìˆ˜ì¹˜í˜• ë°ì´í„° 
- age: í™˜ìì˜ ë‚˜ì´
  - ì‹¬ë¶€ì „ ìœ ë³‘ë¥ ì€ 60ì„¸ ì´ìƒì—ì„œ ê¸‰ì¦í•˜ë©° ë‚˜ì´ê°€ ë“¤ìˆ˜ë¡ ì¦ê°€í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì¡Œë‹¤.
- time: ê´€ì°° ê¸°ê°„ (ì¼)
- **creatinine_phosphokinase: í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ ê²€ì‚¬ ê²°ê³¼**
  - CK (í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ)ëŠ” ì‹¬ì¥, ë‡Œ, ê³¨ê²©ê·¼, ë° ë‹¤ë¥¸ ì¡°ì§ì—ì„œ ë°œê²¬ë˜ëŠ” íš¨ì†Œ
  - CK(í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ) ë†ë„ëŠ” ê·¼ìœ¡ ë˜ëŠ” ì‹¬ì¥ ì„¸í¬ê°€ ì†ìƒë  ë•Œì— ì˜¬ë¼ê°„ë‹¤.
- **ejection_fraction: ë°•ì¶œê³„ìˆ˜ (%)**
  - ë§¥ë°•ì„ í†µí•´ ì‹¬ì¥ì—ì„œ ë°•ì¶œ ë˜ê±°ë‚˜ íŒí”„í•˜ëŠ” í˜ˆì•¡ì˜ %ëŸ‰
  - ë²”ì£¼ëŠ” 0-100%
  - ì˜í•™ì ìœ¼ë¡œ ë°•ì¶œê³„ìˆ˜ê°€ 50% ë˜ëŠ” ë” ë†’ë‹¤ë©´, ì •ìƒ %ë¡œ ê³ ë ¤(ì¹˜ë£Œ í•„ìš” ì—†ìŒ)
  - ë°•ì¶œê³„ìˆ˜ê°€ 50%ë³´ë‹¤ ë‚®ë‹¤ë©´, ì‹¬ì¥ì€ ëŒ€ë¶€ë¶„ ì¶©ë¶„í•œ ì‚°ì†Œê°€ ì—†ë‹¤ê±°ë‚˜, ê´€ìƒë™ë§¥ìœ¼ë¡œ íë¥´ëŠ” í˜ˆì•¡ì´ ë¶€ì¡±í•˜ë‹¤ëŠ” ì˜ë¯¸
- **platelets: í˜ˆì†ŒíŒ ìˆ˜ (kiloplatelets/mL)**
  - ì„±ì¸ì˜ ê²½ìš° í˜ˆì•¡ 1ë§ˆì´í¬ë¡œ ë¦¬í„° ì•ˆì— ì•½ 15~40ë§Œ ê°œì˜ í˜ˆì†ŒíŒì„ ë³´ìœ í•˜ê³  ìˆë‹¤.
  - í˜ˆì†ŒíŒì˜ ìˆ˜ë‚˜ ê¸°ëŠ¥ì— ì´ìƒì´ ìƒê¸°ë©´ ì§€í˜ˆ ì‘ìš©ì— ì˜í–¥ì„ ì£¼ì–´ ì¶œí˜ˆì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤.
- **serum_creatinine: í˜ˆì¤‘ í¬ë ˆì•„í‹´ ë ˆë²¨ (mg/dL)**
  - í¬ë ˆì•„í‹°ë‹Œì€ ê·¼ìœ¡ì—ì„œ ìƒì„±ë˜ëŠ” ë…¸íë¬¼ - ì‹ ì¥ê¸°ëŠ¥ í‰ê°€ì˜ ì£¼ìš” ì§€í‘œ
  - í˜ˆì¤‘ í¬ë ˆì•„í‹°ë‹Œ ë†ë„ì˜ ì •ìƒë²”ìœ„ëŠ” 0.50~1.4 mg/dL
- **serum_sodium: í˜ˆì¤‘ ë‚˜íŠ¸ë¥¨ ë ˆë²¨ (mEq/L)**
  - ê³ ë‚˜íŠ¸ë¥¨í˜ˆì¦ì€ ë³´í†µ í˜ˆì¤‘ë†ë„ê°€ 145mEq/L ì´ìƒì¸ ê²½ìš°ë¥¼ ë§í•¨
  - ê³ ë‚˜íŠ¸ë¥¨í˜ˆì¦ ë°œìƒê¸° ì‹¬í˜ˆê´€ê³„ ì´ìƒ ë°œìƒí•  ìˆ˜ ìˆìŒ
  - 
- ë°ì´í„° ì¶œì²˜: https://www.kaggle.com/andrewmvd/heart-failure-clinical-data

---




# Step 0. ì˜ë£Œ ë°ì´í„°ì…‹ì— ëŒ€í•˜ì—¬
âœ”ï¸ ì˜ë£Œ ë°ì´í„°ì˜ ìˆ˜ì§‘ ê´€ë ¨ ì •ì±…ì˜ ë³€í™”
- í•œêµ­ì˜ ê²½ìš° í•œì •
- 2020.1ì›” ë°ì´í„° 3ë²• ê°œì • ì´í›„ -> 'ê°€ëª…ì •ë³´' ì‚¬ìš©ì´ ê°€ëŠ¥í•´ì§
- ê°œì¸ ì‹ë³„ì´ ê°€ëŠ¥í•œ ì •ë³´ë¥¼ ë¹„ì‹ë³„í™”( de-identification)ì„ í•˜ì—¬ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ê°€ëŠ¥í•œ ë°ì´í„°ë¡œ ë³€í™”ì‹œí‚¨ ê²ƒ

âœ”ï¸ ì˜ë£Œ ë°ì´í„° ë¶„ì„ì˜ í˜„ì¬
- í•´ì™¸ (ë´ë§ˆí¬, ì¼ë³¸, ì˜êµ­, ë¯¸êµ­ ë“±) ì˜ ê²½ìš° ê³¼ê±°ë¶€í„° ì˜ë£Œë°ì´í„° ë¶„ì„ì„ ì‹œí–‰í•´ì˜´.
- ë‹¨ìˆœí•˜ê²ŒëŠ” ë³‘ì› ê³µì‹¤ë¥  ê°œì„ ì„ ìœ„í•œ ë¶„ì„ ë¶€í„° ë„“ê²ŒëŠ” ì§ˆë³‘ë°œìƒ ê°€ëŠ¥ì„± ì˜ˆì¸¡ ê¹Œì§€ ë„“ì€ ë²”ì£¼ì—ì„œ ì˜ë£Œ ê´€ë ¨ ë°ì´í„° ë¶„ì„ì„ ì‹œí–‰
- í•˜ì§€ë§Œ, í•œêµ­ì˜ ê²½ìš° ë°ì´í„° 3ë²• ê°œì • ì´í›„ë¶€í„° ì˜ë£Œ ê´€ë ¨ ë°ì´í„° ë¶„ì„ì´ í™œë°œí•´ì§€ê³  ìˆëŠ” ìƒí™©.

âœ”ï¸ ì£¼ìš” íŒë‹¨ì§€í‘œ : Accuracy, Precision, Recall
- Accuracy : ì˜ˆì¸¡ê²°ê³¼(pred)ì™€ ì‹¤ì œ ê°’(label)ì´ ê°™ì€ ê°œìˆ˜ / ì „ì²´ ë°ì´í„°
- Precision(ì •ë°€ë„) : TPë¼ê³  ì˜ˆì¸¡í–ˆì„ë•Œ ì‹¤ì œë¡œ TPì¼ í™•ë¥  => [ TP/ (FP+TP) ] (FP ë¥¼ ë‚®ì¶”ëŠ”ë° ì´ˆì )
- Recall (ì¬í˜„ìœ¨) : ì‹¤ì œê°’ì´ Positiveì¸ ë°ì´í„° ì¤‘ì—ì„œ ì˜ˆì¸¡ê²°ê³¼(Pred)ì™€ ì‹¤ì œ ê°’(label)ì´ ì¼ì¹˜í•œ ë°ì´í„°ì˜ ë¹„ìœ¨ => [TP / (FN+TP) ] (FNì„ ë‚®ì¶”ëŠ”ë° ì´ˆì )

ğŸ’¡ **ì˜ë£Œ ë°ì´í„° ë¶„ì„ì—ì„œëŠ” **Recall**ì´ ê°€ì¥ ì¤‘ìš”í•œ ì§€í‘œ**
- **Why?**
  - **Recallì´ ì¤‘ìš”í•œ ì§€í‘œì¸ ê²½ìš° : ì‹¤ì œë¡œ Positiveí•œ ê²ƒì„ Negativeë¡œ 'ì˜ëª»' íŒë‹¨í–ˆì„ë•Œ ê·¸ ì˜í–¥ë ¥ì´ ì‹¬ê°í•œ ê²½ìš°
  - ì˜ë£Œ ë°ì´í„°ì˜ ê²½ìš°ê°€ ëŒ€í‘œì ì¸ ì˜ˆì‹œ
  - ì‹¤ì œ ì§ˆë³‘ì„ ì§ˆë³‘ì´ ì—†ë‹¤ê³  ì˜ˆì¸¡í•  ê²½ìš° ê·¸ ì˜ëª»ëœ íŒë‹¨ìœ¼ë¡œ **í™˜ìì˜ ìƒëª…** ì„ ìƒê²Œ ë  ìˆ˜ ë„ ìˆê¸° ë•Œë¬¸.
- ê·¸ë˜ì„œ ì‹¤ì œ ì˜ë£Œ ë¶„ì„ì€ ì—¬ëŸ¬ë‹¨ê³„ë¥¼ ê±°ì¹˜ë©´ì„œ ë¶„ì„í•œë‹¤.
  - 1\) ë¹„êµì  ê°„ë‹¨í•˜ì§€ë§Œ ì •í™•ì„±ì€ ë–¨ì–´ì§€ëŠ” í…ŒìŠ¤íŠ¸ 
  - 2\) '1)'ë³´ë‹¤ëŠ” ì¢€ ë” ë³µì¡í•˜ì§€ë§Œ ì •í™•ì„±ì€ ì¢€ ë” ë†’ì€ í…ŒìŠ¤íŠ¸
  - 3\) '2)'ë³´ë‹¤ëŠ” ì¢€ ë” ë³µì¡í•˜ì§€ë§Œ ì •í™•ì„±ì€ ì¢€ ë” ë†’ì€ í…ŒìŠ¤íŠ¸
  - ì™€ ê°™ì´ ì¡°ê¸ˆì”© ë” ë³µì¡í•˜ë©´ì„œ ì •í™•ì„±ì´ ë” ë†’ì€ í…ŒìŠ¤íŠ¸ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì‹œí–‰
  - e.g) MRI -> í˜ˆì•¡ ê²€ì‚¬ -> ì¡°ì§ê²€ì‚¬
- ì¦‰, ì¼ë°˜ì ìœ¼ë¡œ ì˜ë£Œë¶„ì„ì€ ìƒëŒ€ì ìœ¼ë¡œ ì‰½ê²Œ ì–»ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°ë“¤ì„ ì¡°í•©í•´ì„œ ì°¨ê·¼ ì°¨ê·¼ ë¶„ì„ ì •í™•ë„ë¥¼ ë†’ì—¬ê°€ê¸° ë•Œë¬¸ì— ì´ˆë°˜ì—ëŠ” Recall ì´ ë†’ì€ ë¶„ì„ë°©ë²•ì´ ë” ì¤‘ìš”í•˜ë‹¤.

ğŸ¤” ê·¸ë˜ë„ ìµœì¢…ì ìœ¼ë¡œëŠ” Precision ê³¼ Recallì´ ëª¨ë‘ ë†’ì€ ë°©ë²•ì„ ì‚¬ìš©
- **Recallì„ 100%ë¡œ ë§Œë“œëŠ” ê²ƒì„ ì¶”êµ¬í•˜ë©´ Precisionì€ 0ì— ê°€ê¹Œì›Œ ì§„ë‹¤.**
  - ê°€ë ¹, ë¬´í•œëŒ€ì˜ í™˜ìê°€ ìˆë‹¤ê³  ê°€ì •íˆí• ë•Œ
  - Recallì„ 100%ë¡œ ë§Œë“¤ë ¤ë©´ ë¬´í•œëŒ€ì˜ ëª¨ë“  í™˜ìì—ê²Œ ë³‘ì´ ìˆë‹¤. (True) ë¼ê³  ì§„ë‹¨í•˜ë©´ ëœë‹¤.
  - í•˜ì§€ë§Œ ì´ ê²½ìš° Precision ì„ ì¸¡ì •í•˜ë©´ ë¶„ëª¨ê°’ì´ í™˜ììˆ˜(ë¬´í•œëŒ€) ì´ê¸° ë•Œë¬¸ì— 0ìª½ìœ¼ë¡œ í•˜ë½í•œë‹¤.
  - ê·¸ëŸ¬ë¯€ë¡œ, **Recallì€ 95%ì´ìƒì„ ì¶”êµ¬í•˜ë©´ì„œ Precisionì„ ë–¨ì–´ì§€ì§€ ì•Šë„ë¡ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”**í•˜ë‹¤.
---




# Step 1. ë°ì´í„°ì…‹ ì¤€ë¹„í•˜ê¸°

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# ì»¬ëŸ¼ ì „ì²´ í™•ì¸ ê°€ëŠ¥í•˜ë„ë¡ ì¶œë ¥ ë²”ìœ„ ì„¤ì •
pd.set_option('display.max_columns', 500)
pd.set_option('display.width', 1000)

# ë¶ˆí•„ìš”í•œ ê²½ê³  í‘œì‹œ ìƒëµ
import warnings
warnings.filterwarnings(action = 'ignore')
```

##  Kaggle API ë¡œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ì…‹íŒ…

```python
# ë‹¤ìš´ë¡œë“œ íŒ¨í‚¤ì§€
import opendatasets as od

# os ëª…ë ¹ ê´€ë ¨ íŒ¨í‚¤ì§€
import os
```

#username = gabesoon

#user key = f7dab1c856bc634fde741afaf75781ea

od.download("https://www.kaggle.com/rashikrahmanpritom/heart-attack-analysis-prediction-dataset")

```python
os.listdir()
```


['.ipynb_checkpoints',
 'heart-attack-analysis-prediction-dataset',
 'heart_failure_clinical_records_dataset.csv',
 '[ë¶„ë¥˜] ë°ì´í„° ë¶„ì„ìœ¼ë¡œ ì‹¬ë¶€ì „ì¦ì„ ì˜ˆì¸¡í•˜ê¸° (Kaggle ë°ì´í„°).ipynb']


## Pandas ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ csvíŒŒì¼ ì½ì–´ë“¤ì´ê¸°

```python
# ë°ì´í„° ë¡œë“œ
df = pd.read_csv('heart_failure_clinical_records_dataset.csv')
```

```python
# ë°ì´í„° í™•ì¸
print(df.info())
df.head()
```



RangeIndex: 299 entries, 0 to 298
Data columns (total 13 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  


0   age                       299 non-null    float64
 1   anaemia                   299 non-null    int64  
 2   creatinine_phosphokinase  299 non-null    int64  
 3   diabetes                  299 non-null    int64  
 4   ejection_fraction         299 non-null    int64  
 5   high_blood_pressure       299 non-null    int64  
 6   platelets                 299 non-null    float64
 7   serum_creatinine          299 non-null    float64
 8   serum_sodium              299 non-null    int64  
 9   sex                       299 non-null    int64  
 10  smoking                   299 non-null    int64  
 11  time                      299 non-null    int64  
 12  DEATH_EVENT               299 non-null    int64  
dtypes: float64(3), int64(10)
memory usage: 30.5 KB
None





- ì´ 299ëª…ì˜ í™˜ì ë°ì´í„°

- Columns ëŠ” 13ê°œ

- NaNê°’ ìˆëŠ” columns ì—†ìŒ

______

**ë²”ì£¼í˜• ë°ì´í„° : count í™•ì¸**

- anaemia: í™˜ìì˜ ë¹ˆí˜ˆì¦ ì—¬ë¶€ (0: ì •ìƒ, 1: ë¹ˆí˜ˆ)

- diabetes: ë‹¹ë‡¨ë³‘ ì—¬ë¶€ (0: ì •ìƒ, 1: ë‹¹ë‡¨)

- high_blood_pressure: ê³ í˜ˆì•• ì—¬ë¶€ (0: ì •ìƒ, 1: ê³ í˜ˆì••)

- sex: ì„±ë³„ (0: ì—¬ì„±, 1: ë‚¨ì„±)

- smoking: í¡ì—° ì—¬ë¶€ (0: ë¹„í¡ì—°, 1: í¡ì—°)

- DEATH_EVENT: ì‚¬ë§ ì—¬ë¶€ (0: ìƒì¡´, 1: ì‚¬ë§)

**ìˆ˜ì¹˜í˜• ë°ì´í„° : ì „ë°˜ì ì¸ í†µê³„ëŸ‰ í™•ì¸**

- age: í™˜ìì˜ ë‚˜ì´

- creatinine_phosphokinase: í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ ê²€ì‚¬ ê²°ê³¼

- ejection_fraction: ë°•ì¶œê³„ìˆ˜ (%)

- platelets: í˜ˆì†ŒíŒ ìˆ˜ (kiloplatelets/mL)

- serum_creatinine: í˜ˆì¤‘ í¬ë ˆì•„í‹´ ë ˆë²¨ (mg/dL)

- serum_sodium: í˜ˆì¤‘ ë‚˜íŠ¸ë¥¨ ë ˆë²¨ (mEq/L)

- time: ê´€ì°° ê¸°ê°„ (ì¼)

```python
df.describe()
```





1) í™˜ìì˜ ë‚˜ì´ ë¶„í¬ëŠ” 40~95ì„¸ ì‚¬ì´ì´ê³ , í‰ê·  ì—°ë ¹ì€ 60.83ì´ë‹¤.

2) (0,1) ë¡œëœ ë²”ì£¼í˜• ë°ì´í„°ì˜ í‰ê· ê°’ì„ ë³´ë©´ ëŒ€ë¶€ë¶„ 0.35~0.64 ë²”ì£¼ì•ˆì— ìˆë‹¤ = íŠ¹ë³„í•˜ê²Œ ë¶ˆê· í˜•í•œ ë°ì´í„°ëŠ” ì—†ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.

(ëŒ€ë¶€ë¶„ì˜ ë°ì´í„°ê°€ 6:4 ì •ë„ì˜ ë¹„ìœ¨) - ìš©ì¸ ê°€ëŠ¥í•œ ìˆ˜ì¤€ 

ë‹¨, ì‚¬ë§ì ë°ì´í„°ëŠ” 0.32ë¡œ 1/3ì´ ìƒì¡´ì´ë¼ ë‹¤ì†Œ ë¶ˆê· í˜•ì´ë‹¤.

3) creatinine_phosphokinase ì˜ ê²½ìš° minê°’ì€ 23, 50%ê°’ì€ 250, 75%ê°’ì€ 582ì¸ë°, maxê°’ì€ 7861ë¡œ ì´ìƒì¹˜ì¼ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤. (ì œì™¸ í•´ì•¼í•  ìˆ˜ë„ ìˆë‹¤.)
---


# Step 2. EDA ë° ë°ì´í„° ê¸°ì´ˆ í†µê³„ ë¶„ì„
---


## ìˆ˜ì¹˜í˜• ë°ì´í„°ë³„ Histogram - ë°ì´í„° ë¹ˆë„ with DEATH_EVENT

### ì—°ë ¹ëŒ€ë³„ ì‚¬ë§ìˆ˜ ë¶„í¬

```python
# seabornì˜ histplot, jointplot, pairplotì„ ì´ìš©
# kde = íˆìŠ¤í† ê·¸ë¨ ë¶„í¬ë¥¼ ê³¡ì„ ìœ¼ë¡œ í‘œí˜„
# gray = 1 ì´ì§€ë§Œ 0ê³¼ ê²¹ì¹œ ë°ì´í„°

sns.histplot(x='age', data=df, hue='DEATH_EVENT', kde=True)
```






- age ë°ì´í„°ëŠ” longtail í˜•íƒœì˜ ë°ì´í„°(ì•ìª½ ë°ì´í„°ì˜ ë¹ˆë„ê°€ ë†’ê³  ë’¤ë¡œ ê°ˆìˆ˜ë¡ ë¹ˆë„ê°€ ë‚®ì•„ì§€ëŠ” í˜•íƒœ)

### í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ ê²€ì‚¬ ê²°ê³¼ (3000ì´í•˜ì¸ ê²ƒë§Œ) 

creatinine_phosphokinase: í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ ê²€ì‚¬ ê²°ê³¼

1) CK (í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ)ëŠ” ì‹¬ì¥, ë‡Œ, ê³¨ê²©ê·¼, ë° ë‹¤ë¥¸ ì¡°ì§ì—ì„œ ë°œê²¬ë˜ëŠ” íš¨ì†Œ

2) CK(í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ) ë†ë„ëŠ” ê·¼ìœ¡ ë˜ëŠ” ì‹¬ì¥ ì„¸í¬ê°€ ì†ìƒë  ë•Œì— ì˜¬ë¼ê°„ë‹¤.

---


- creatinine_phosphokinase ëŠ” describe()ë¡œ ë³´ì•˜ì„ë•Œ **outlierê°€ ì¡´ì¬í•˜ëŠ”** ë°ì´í„°ì˜€ë‹¤.

- ì‹¤ì œë¡œ ê°’ì´ 3000 ì´ìƒì¸ ê²½ìš° ë°ì´í„°ì˜ countê°€ ë‚®ì•„ì„œ ì „ì²´ ë°ì´í„°ë¥¼ ì‹œê°í™”í•  ê²½ìš° ë°ì´í„°ë¥¼ í¬ê²Œ ë³´ê¸°ê°€ ì–´ë ¤ì› ë‹¤.

- ë¹ˆë„ìˆ˜ê°€ ë§ì€ ë°ì´í„°ë¥¼ ì‚´í”¼ê¸° ìœ„í•´ ê°’ì´ **3000ì´í•˜ ì¸ ë°ì´í„°**ë“¤ë§Œ ì¶”ë ¤ì„œ ì‹œê°í™” í•˜ì˜€ë‹¤.

```python
a = df.loc[df['creatinine_phosphokinase'] 




### ejection_fraction: ë°•ì¶œê³„ìˆ˜ (%) - íˆìŠ¤í† ê·¸ë¨

```python
# bins ì¡°ì ˆë¡œ ë¹ˆìë¦¬ê°€ ì—†ë„ë¡ ì¡°ì ˆ
sns.histplot(x='ejection_fraction', data=df, bins=13, hue='DEATH_EVENT', kde=True)
```






ejection_fraction: ë°•ì¶œê³„ìˆ˜ (%)

1) ë§¥ë°•ì„ í†µí•´ ì‹¬ì¥ì—ì„œ ë°•ì¶œ ë˜ê±°ë‚˜ íŒí”„í•˜ëŠ” í˜ˆì•¡ì˜ %ëŸ‰

2) ë²”ì£¼ëŠ” 0-100%

3) ì˜í•™ì ìœ¼ë¡œ ë°•ì¶œê³„ìˆ˜ê°€ 50% ë˜ëŠ” ë” ë†’ë‹¤ë©´, ì •ìƒ %ë¡œ ê³ ë ¤(ì¹˜ë£Œ í•„ìš” ì—†ìŒ)

4) ë°•ì¶œê³„ìˆ˜ê°€ 50%ë³´ë‹¤ ë‚®ë‹¤ë©´, ì‹¬ì¥ì€ ëŒ€ë¶€ë¶„ ì¶©ë¶„í•œ ì‚°ì†Œê°€ ì—†ë‹¤ê±°ë‚˜, ê´€ìƒë™ë§¥ìœ¼ë¡œ íë¥´ëŠ” í˜ˆì•¡ì´ ë¶€ì¡±í•˜ë‹¤ëŠ” ì˜ë¯¸

---


- ì „ë°˜ì ìœ¼ë¡œ ejection_fractionì´ ë‚®ì€ ì‚¬ëŒì˜ ì‚¬ë§ìˆ˜ê°€ ë†’ê³ , ë†’ì€ ì‚¬ëŒì€ ì‚¬ë§ìˆ˜ê°€ ë‚®ì€ ê²½í–¥ì„ ë³´ì¸ë‹¤.(ë„ë©”ì¸ ì§€ì‹ê³¼ ë™ì¼)

- ì‚¬ë§ììˆ˜ì™€ ë°˜ë¹„ë¡€ í˜•íƒœì˜ ê´€ê³„ë¥¼ ë³´ì´ê³ , ê° ë¹ˆë„ ë³„ë¡œ ì‚¬ë§ììˆ˜ì˜ ë¹„ìœ¨ì— ì°¨ì´ëŠ” ìˆì§€ë§Œ ì‚¬ë§ìˆ˜ëŠ” ì „ë°˜ì ìœ¼ë¡œ ë†’ê²Œ ë¶„í¬ë˜ì–´ ìˆì–´ ì‚¬ë§ ì—¬ë¶€ íŒë³„ì— ì¤‘ìš”í•œ ë°ì´í„°ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒëœë‹¤.

- íŠ¹íˆ Precisionì„ ë†’ì´ê¸° ìœ„í•œ ë°ì´í„°ë¡œëŠ” ìœ ìš©í•  ê²ƒì´ë‹¤.(ì‚¬ë§í•œ ê²½ìš°ìì²´ê°€ ë§ìŒ-> TPì¦ê°€ -> FP ë‚®ì•„ì§ -> Precision ë‚®ì•„ì§)

- ë‹¤ë§Œ Recallì„ ë†’ì´ëŠ”ë°ëŠ” í¬ê²Œ ìœ ìš©í•œ ë°ì´í„°ëŠ” ì•„ë‹ ê²ƒì´ë‹¤.

### ê´€ì°°ì¼ìˆ˜(time) - íˆìŠ¤í† ê·¸ë¨

```python
sns.histplot(x='time', data=df, hue='DEATH_EVENT', kde=True)
```






- ê´€ì°°ê¸°ê°„(time)ì— ëŒ€í•œ ë°ì´í„°ê°€ ì´ˆë°˜ì— ë§ì´ ëª°ë ¤ìˆê³ , ê´€ì°°ê¸°ê°„ì´ ê¸´ ë°ì´í„°ì¼ ìˆ˜ë¡ ë¶„í¬ê°€ ë–¨ì–´ì§„ë‹¤. (Gamma distribution)

- ìƒì¡´ë°ì´í„°ì˜ ê²½ìš° 'ìŒë´‰ í˜•íƒœ' ì´ë‹¤. ìƒì¡´ìì— ëŒ€í•œ ëŒ€ë¶€ë¶„ì˜ ë°ì´í„°ê°€ 2ê³³ì— ì§‘ì•½ë˜ì–´ ìˆëŠ” ê²ƒ.

- ì‚¬ë§ìê°€ ë°œìƒí•˜ë©´ ê´€ì°°ê¸°ê°„(time)ì˜ ê°’ì´ ë” ë†’ì•„ì§ˆìˆ˜ê°€ ì—†ëŠ” êµ¬ì¡°ì´ë‹¤.

- ê·¸ëŸ¬ë¯€ë¡œ **time ë°ì´í„°ëŠ” ì œì™¸í•˜ê³  í•™ìŠµì„ ì§„í–‰í•˜ëŠ” ê²ƒ**ì´ ë°”ëŒì§ í•˜ë‹¤.

### ejection_fraction: ë°•ì¶œê³„ìˆ˜ (%) - Boxplot

```python
# seabornì˜ Boxplot ê³„ì—´(boxplot(), violinplot(), swarmplot())ì„ ì‚¬ìš©

# ejection_fraction: ë°•ì¶œê³„ìˆ˜ (%)
sns.boxplot(x='DEATH_EVENT', y='ejection_fraction', data=df)
```






[ë„ë©”ì¸ ì§€ì‹]

- ejection_fractionì´ 50%ë³´ë‹¤ ë‚®ë‹¤ë©´, ì‹¬ì¥ì€ ëŒ€ë¶€ë¶„ ì¶©ë¶„í•œ ì‚°ì†Œê°€ ì—†ë‹¤ê±°ë‚˜, ê´€ìƒë™ë§¥ìœ¼ë¡œ íë¥´ëŠ” í˜ˆì•¡ì´ ë¶€ì¡±í•˜ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

---


[Boxplot ë¶„ì„]

- ìƒì¡´ìì˜ ejection_fraction í‰ê· ì€ ì•½ 40ì´ë‹¤.

- ì‚¬ë§ìì˜ ejection_fraction í‰ê· ì€ ì•½ 30 ì´ë‹¤.

---


- ejection_fractionì€ ë„ë©”ì¸ ì§€ì‹ ë§Œí¼ì€ ì•„ë‹ˆê² ì§€ë§Œ, ì‚¬ë§ìì™€ ìƒì¡´ìê°„ì˜ í‰ê·  ì°¨ì´ê°€ ìƒë‹¹í•˜ë¯€ë¡œ ì‚¬ë§ììˆ˜ ì™€ì˜ ìƒê´€ì„±ì´ ìˆëŠ” ì£¼ìš” ì§€í‘œì¼ ê²ƒìœ¼ë¡œ ì˜ˆìƒëœë‹¤.

### í˜ˆì†ŒíŒ ìˆ˜ (kiloplatelets/mL)

```python
sns.histplot(x='platelets', data=df, hue='DEATH_EVENT')
```






platelets: í˜ˆì†ŒíŒ ìˆ˜ (kiloplatelets/mL)

1) ì„±ì¸ì˜ ê²½ìš° í˜ˆì•¡ 1ë§ˆì´í¬ë¡œ ë¦¬í„° ì•ˆì— ì•½ 15~40ë§Œ ê°œì˜ í˜ˆì†ŒíŒì„ ë³´ìœ í•˜ê³  ìˆë‹¤.

2) í˜ˆì†ŒíŒì˜ ìˆ˜ë‚˜ ê¸°ëŠ¥ì— ì´ìƒì´ ìƒê¸°ë©´ ì§€í˜ˆ ì‘ìš©ì— ì˜í–¥ì„ ì£¼ì–´ ì¶œí˜ˆì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤.

- í˜ˆì†ŒíŒ ìˆ˜ì˜ ë°ì´í„°ì™€ ì‚¬ë§ììˆ˜ ê°„ì˜ ì—°ê´€ì„±ì´ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.

### ê´€ì°° ê¸°ê°„ (ì¼)

```python
sns.histplot(x='time', data=df, hue='DEATH_EVENT', kde=True)
```






- ì „ë°˜ì ìœ¼ë¡œ ë³¼ë•Œ, ê´€ì°° ê¸°ê°„ì´ ì§§ì„ë•Œ ì‚¬ë§ììˆ˜ê°€ ë§ì§€ë§Œ ê´€ì°° ê¸°ê°„ì´ ê¸¸ì–´ì§ˆ ìˆ˜ë¡ ì‚¬ë§ììˆ˜ê°€ ì ì–´ì§€ëŠ” ê²½í–¥ì´ ìˆë‹¤.

- ë‹¤ë§Œ, ê´€ì°° ê¸°ê°„ì´ ì¤‘ê°„ì¹˜ì¼ë•ŒëŠ” ì‚¬ë§ììˆ˜ì˜ ë¶„í¬ê°€ ê· ì¼í•˜ë‹¤.

- ê·¸ëŸ¬ë¯€ë¡œ ê´€ì°° ê¸°ê°„ì´ ì‚¬ë§ììˆ˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ”ë° ê²°ì •ì ì¸ ì§€í‘œë¼ê³  í•˜ê¸°ëŠ” ì–´ë µë‹¤.

## ìˆ˜ì¹˜í˜• ë°ì´í„°ë³„ Jointplot 

### [í˜ˆì†ŒíŒ ìˆ˜ (kiloplatelets/mL) x í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ ê²€ì‚¬ ê²°ê³¼] X ì‚¬ë§ì ìˆ˜ 

creatinine_phosphokinase: í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ ê²€ì‚¬ ê²°ê³¼

1) CK (í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ)ëŠ” ì‹¬ì¥, ë‡Œ, ê³¨ê²©ê·¼, ë° ë‹¤ë¥¸ ì¡°ì§ì—ì„œ ë°œê²¬ë˜ëŠ” íš¨ì†Œ

2) CK(í¬ë ˆì•„í‹´í‚¤ë‚˜ì œ) ë†ë„ëŠ” ê·¼ìœ¡ ë˜ëŠ” ì‹¬ì¥ ì„¸í¬ê°€ ì†ìƒë  ë•Œì— ì˜¬ë¼ê°„ë‹¤.

```python
#sns.jointplot(x='platelets', y='creatinine_phosphokinase', hue='DEATH_EVENT', data=df, alpha=0.4)
sns.jointplot(x='platelets', y='creatinine_phosphokinase',data=df, kind='kde', hue='DEATH_EVENT')
```






### [ë°•ì¶œê³„ìˆ˜ (%) x í˜ˆì¤‘ ë‚˜íŠ¸ë¥¨ ë ˆë²¨ (mEq/L)] X ì‚¬ë§ì ìˆ˜ 

```python
sns.jointplot(x='ejection_fraction', y='serum_creatinine', data=df, hue='DEATH_EVENT')
```






## ë²”ì£¼í˜• ë°ì´í„°ë³„ Boxplot

### í¡ì—°ìì—¬ë¶€ ë³„ ë°•ì¶œê³„ìˆ˜

```python
sns.boxplot(x='smoking', y='ejection_fraction', data=df)
```






[ë„ë©”ì¸ ì§€ì‹]

- ejection_fractionì´ 50%ë³´ë‹¤ ë‚®ë‹¤ë©´, ì‹¬ì¥ì€ ëŒ€ë¶€ë¶„ ì¶©ë¶„í•œ ì‚°ì†Œê°€ ì—†ë‹¤ê±°ë‚˜, ê´€ìƒë™ë§¥ìœ¼ë¡œ íë¥´ëŠ” í˜ˆì•¡ì´ ë¶€ì¡±í•˜ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

---


[Boxplot ë¶„ì„]

- í¡ì—°ìì™€ ë¹„í¡ì—°ìê°„ ë°ì´í„°ì˜ í‰ê· ì€ í° ì°¨ì´ê°€ ì—†ë‹¤.

- í¡ì—°ìì˜ ê²½ìš° ejection_fraction ê°’ì˜ ë²”ìœ„ê°€ ì¢ë‹¤. 

- í¡ì—°ìì˜ ejection_fraction ìµœê³ ì¹˜ê°€ ë” ë‚®ë‹¤. 

- í¡ì—°ìì˜ ejection_fraction í‰ê· ì€ 30 ì¤‘ë°˜ì´ë‹¤.

- ë¹„í¡ì—°ìì˜ ejection_fraction í‰ê· ì€ 30 í›„ë°˜ì´ë‹¤.

---


- í¡ì—°ìì˜ ejection_fraction í‰ê· ì€ ì •ìƒì¹˜ ì•„ë˜ì´ë¯€ë¡œ ì‹¬ì¥ì— ë¬¸ì œê°€ ìˆì„ ê°€ëŠ¥ì„±ì´ ìˆë‹¤ê³  ì˜ˆìƒí•  ìˆ˜ ìˆë‹¤.

- ì¦‰, í¡ì—°ì—¬ë¶€ëŠ” ì‹¬ë¶€ì „ì¦ì— ê°„ì ‘ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•œ ë°ì´í„°ì¼ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤.

- ë‹¤ë§Œ ì´ ë°ì´í„°ì—ì„œëŠ” ë¹„í¡ì—°ìì˜ ejection_fractionë„ í‰ê· ì´ 40 ì•„ë˜ì´ë¯€ë¡œ ë„ë©”ì¸ ì§€ì‹ë§Œí¼ ì‹¬ë¶€ì „ ë°œìƒì—¬ë¶€ì™€ ê°•ë ¥í•œ ì—°ê´€ì„±ì„ ë³´ì´ì§€ ì•Šì„ ê°€ëŠ¥ì„±ì´ í¬ë‹¤.

### í¡ì—°ì—¬ë¶€ ë³„ ì‚¬ë§ììˆ˜ x í˜ˆì†ŒíŒ ìˆ˜ (kiloplatelets/mL)

```python
sns.swarmplot(x='DEATH_EVENT', y='platelets', hue='smoking', data=df)
```






---


# Step 3. ë°ì´í„° ì „ì²˜ë¦¬

## ë°ì´í„° í‘œì¤€í™”

```python
from sklearn.preprocessing import StandardScaler
```

```python
# í˜•íƒœë³„ ë°ì´í„° ë¶„ë¥˜ë¥¼ ìœ„í•´ columns í™•ì¸ - ë³µì‚¬í•´ì„œ ì‚¬ìš©
df.columns
```


Index(['age', 'anaemia', 'creatinine_phosphokinase', 'diabetes', 'ejection_fraction', 'high_blood_pressure', 'platelets', 'serum_creatinine', 'serum_sodium', 'sex', 'smoking', 'time', 'DEATH_EVENT'], dtype='object')


```python
# ìˆ˜ì¹˜í˜• ì…ë ¥ ë°ì´í„°, ë²”ì£¼í˜• ì…ë ¥ ë°ì´í„°, ì¶œë ¥ ë°ì´í„°ë¡œ êµ¬ë¶„í•˜ê¸°

#ë²”ì£¼í˜•
X_num = df[['age', 'creatinine_phosphokinase','ejection_fraction', 'platelets','serum_creatinine', 'serum_sodium']]

#ìˆ˜ì¹˜í˜•
X_cat = df[['anaemia', 'diabetes', 'high_blood_pressure', 'sex', 'smoking']]

#ì¶œë ¥ (label)
y = df['DEATH_EVENT']
```

```python
# ìˆ˜ì¹˜í˜• ì…ë ¥ ë°ì´í„°ë¥¼ í‘œì¤€í™” & ì…ë ¥ ë°ì´í„° í†µí•©
scaler = StandardScaler()
scaler.fit(X_num)
X_scaled = scaler.transform(X_num)
X_scaled = pd.DataFrame(data=X_scaled, index=X_num.index, columns=X_num.columns)

# ê²°ê³¼ í†µí•©
X = pd.concat([X_scaled, X_cat], axis=1)
```

```python
X.head()
```





## Train / Test Split

```python
from sklearn.model_selection import train_test_split
```

```python
# í•™ìŠµ / í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ë¶„ë¦¬ (7:3)
# ì‹œê°„ ìˆœì„œ ìƒê´€ì´ ì—†ìœ¼ë¯€ë¡œ shuffle=True ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1) 
```

---


# Step 4. Classification ëª¨ë¸ í•™ìŠµ

## Logistic Regression ìœ¼ë¡œ ê¸°ë³¸ì ì¸ ë¶„ë¥˜ ë¶„ì„ ì§„í–‰

### Logistic Regression ëª¨ë¸ ìƒì„± & í•™ìŠµ

```python
from sklearn.linear_model import LogisticRegression
```

```python
# ëª¨ë¸ ìƒì„±
# max_iter : Gradient Descent ìˆ˜í–‰ íšŸìˆ˜
model_lr = LogisticRegression(max_iter=1000)

# ëª¨ë¸ í•™ìŠµ
model_lr.fit(X_train, y_train)
```


LogisticRegression(max_iter=1000)

### ëª¨ë¸ ê²°ê³¼ í‰ê°€1

```python
from sklearn.metrics import accuracy_score, precision_score , recall_score , confusion_matrix

def get_eval(y_test , pred):
    confusion = confusion_matrix( y_test, pred)
    accuracy = accuracy_score(y_test , pred)
    precision = precision_score(y_test , pred)
    recall = recall_score(y_test , pred)
    print('ì˜¤ì°¨ í–‰ë ¬')
    print(confusion)
    print('ì •í™•ë„: {0:.2f}, ì •ë°€ë„: {1:.2f}, ì¬í˜„ìœ¨: {2:.2f}'.format(accuracy , precision ,recall))
```

```python
from sklearn.metrics import classification_report
```

```python
# ì˜ˆì¸¡ê°’ predì— í• ë‹¹
pred = model_lr.predict(X_test)

# ê²°ê³¼ ì¶œë ¥
print(classification_report(y_test, pred))
```


              precision    recall  f1-score   support

           0       0.78      0.92      0.84        64
           1       0.64      0.35      0.45        26

    accuracy                           0.76        90
   macro avg       0.71      0.63      0.65        90
weighted avg       0.74      0.76      0.73        90



```python
get_eval(y_test,pred)
```


ì˜¤ì°¨ í–‰ë ¬
[[59  5]
 [17  9]]
ì •í™•ë„: 0.76, ì •ë°€ë„: 0.64, ì¬í˜„ìœ¨: 0.35


---


# Step 5. ì•™ìƒë¸”ë¡œ ë¨¸ì‹ ëŸ¬ë‹ ê²°ê³¼ í–¥ìƒ ì‹œí‚¤ê¸°

## ì¶”ê°€ëª¨ë¸ (XGBoost) ìƒì„±&í•™ìŠµ

```python
from xgboost import XGBClassifier
```

```python
# ëª¨ë¸ ìƒì„±
model_xgb = XGBClassifier()

# ëª¨ë¸ í•™ìŠµ
model_xgb.fit(X_train, y_train)
```


[14:33:57] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.


XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,
              colsample_bynode=1, colsample_bytree=1, gamma=0, gpu_id=-1,
              importance_type='gain', interaction_constraints='',
              learning_rate=0.300000012, max_delta_step=0, max_depth=6,
              min_child_weight=1, missing=nan, monotone_constraints='()',
              n_estimators=100, n_jobs=6, num_parallel_tree=1, random_state=0,
              reg_alpha=0, reg_lambda=1, scale_pos_weight=1, subsample=1,
              tree_method='exact', validate_parameters=1, verbosity=None)

## ì¶”ê°€ ëª¨ë¸ í•™ìŠµ ê²°ê³¼ í‰ê°€

```python
# ì˜ˆì¸¡
pred = model_xgb.predict(X_test)

# ê²°ê³¼ ì¶œë ¥
print(classification_report(y_test, pred))
```


              precision    recall  f1-score   support

           0       0.81      0.88      0.84        64
           1       0.62      0.50      0.55        26

    accuracy                           0.77        90
   macro avg       0.72      0.69      0.70        90
weighted avg       0.76      0.77      0.76        90


- Precisionê³¼ Recallì€ ì •í™•ë„ë¥¼ ì¸¡ì •í•˜ëŠ” ê´€ì ì´ ì„œë¡œ ë‹¤ë¥´ë‹¤.

- ë•Œë¬¸ì— ì–´ëŠ í•˜ë‚˜ê°€ ë†’ë‹¤ê³  ë¬´ì¡°ê±´ ì¢‹ì€ ê²°ê³¼ë¼ í•  ìˆ˜ ì—†ë‹¤.

- ì´ ë‘˜ì„ ëª¨ë‘ ê³ ë ¤í•œ ê°’ì´ f1-score ì´ë‹¤. (Precision & Recallì˜ ì¡°í™”í‰ê· )

```python
get_eval(y_test,pred)
```


ì˜¤ì°¨ í–‰ë ¬
[[56  8]
 [13 13]]
ì •í™•ë„: 0.77, ì •ë°€ë„: 0.62, ì¬í˜„ìœ¨: 0.50


---


# Step 6. ë¶„ì„ê²°ê³¼ì—ì„œ Insight ì°¾ê¸°

##  Feature importance í™•ì¸í•˜ê¸°

```python
plt.barh(X.columns, model_xgb.feature_importances_) # ê°€ë¡œ ì¶œë ¥ (barh)

plt.show()
```



- serum_creatinineì´ ê°€ì¥ ì¤‘ìš”í•œ ìš”ì†Œì´ë‹¤.

- ejection_fraction ì´ ë‘ë²ˆì§¸ë¡œ ì¤‘ìš”í•œ ìš”ì†Œì´ë‹¤.

- ageê°€ ì„¸ë²ˆì§¸ë¡œ ì¤‘ìš”í•œ ìš”ì†Œì´ë‹¤.

ì¦‰ ì‹¬ë¶€ì „ì¦ ì˜ˆì¸¡ì„ ìœ„í•´ ìœ„ì˜ 3 ìš”ì†Œë¥¼ ì¤‘ì ì ìœ¼ë¡œ ì‚´í´ ë³´ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.

```python
sns.jointplot(x='ejection_fraction', y='serum_creatinine', data=df, hue='DEATH_EVENT')
```






- ì£¼ìš” ë³€ìˆ˜ë¡œ íŒë³„ëœ 2ê°œì˜ featureì—ì„œ ë°œìƒí•œ DEATH_EVENTê°€ ì„œë¡œ êµ¬ë¶„ì´ ì˜ ëœë‹¤. 

- ì´ ë°ì´í„°ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ì‹¬ë¶€ì „ì¦ ì—¬ë¶€ë¥¼ íŒë³„í•˜ê²Œ ëœë‹¤ë©´ ë¶„ë¥˜ë¥¼ ì˜ í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒ ëœë‹¤.

---


# Step 7. ë‘ê°œì˜ ëª¨ë¸ í•™ìŠµ ê²°ê³¼ ì‹¬í™” ë¶„ì„

## Precision-Recall ì»¤ë¸Œ í™•ì¸ - ì£¼ë¡œ ë¶ˆê· í˜•í•œ ë°ì´í„°ë¥´ í‰ê°€í• ë•Œ ì‚¬ìš©

```python
from sklearn.metrics import plot_precision_recall_curve
```

```python
# ë‘ ëª¨ë¸ì˜ Precision-Recall ì»¤ë¸Œë¥¼ í•œë²ˆì— ê·¸ë¦¬ê¸°
fig = plt.figure() #ê¸°ë³¸ figure ìƒì„±

ax = fig.gca() #ì—¬ëŸ¬ê°œì˜ xë¥¼ ì‚¬ìš©í•´ í•˜ë‚˜ì˜ ìº”ë²„ìŠ¤ì— ê·¸ë¦¬ê¸° ìœ„í•´ ì‚¬ìš©

plot_precision_recall_curve(model_lr, X_test, y_test, ax=ax)
plot_precision_recall_curve(model_xgb, X_test, y_test, ax=ax)
```






- 2ê°œì˜ ê·¸ë˜í”„ë¥¼ ë¹„êµí•˜ì˜€ì„ë•Œ ìœ„ìª½ì— ìœ„ì¹˜í•œ ê²ƒì´ ë” ì •í™•ë„ê°€ ë†’ì€ ëª¨ë¸ì´ë€ ëœ»ì´ë‹¤.

- ì „ë°˜ì ìœ¼ë¡œ XGBClassifierì´ ë” ë†’ì€ ì„±ëŠ¥ì„ ë³´ì—¬ì£¼ê³  ìˆë‹¤.

## ROC ì»¤ë¸Œ í™•ì¸í•˜ê¸° - ì£¼ë¡œ ê· í˜•ì¸ ë°ì´í„°ë¥¼ í‰ê°€í• ë•Œ ì‚¬ìš©

```python
from sklearn.metrics import plot_roc_curve
```

```python
# ë‘ ëª¨ë¸ì˜ ROC ì»¤ë¸Œë¥¼ í•œë²ˆì— ê·¸ë¦¬ê¸°
fig = plt.figure()
ax = fig.gca()
plot_roc_curve(model_lr, X_test, y_test, ax=ax)
plot_roc_curve(model_xgb, X_test, y_test, ax=ax)
```






- TP(True Positive) rateê°€ ë‚®ì„ë•Œ ì–¼ë§ˆë‚˜ ë¹¨ë¦¬ 1ì— ê°€ê¹Œì›Œ ì§€ëŠ”ì§€ë¡œ í‰ê°€

- AUC (Area Under Curve) : ê·¸ë˜í”„ ì•„ë˜ì˜ ì˜ì—­ì˜ ë„“ì´ ê°’

- ì „ë°˜ì ìœ¼ë¡œ LogisticRegressionì´ ë” ë†’ì€ ì„±ëŠ¥ì„ ë³´ì—¬ì£¼ê³  ìˆë‹¤.

---





# ê²°ë¡ 

- ì£¼ì–´ì§„ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë³´ì•˜ì„ë•Œ ì‹¬ë¶€ì „ì¦ ì˜ˆì¸¡ì— ì¤‘ìš”í•œ ìš”ì†ŒëŠ” serum_creatinine(í˜ˆì¤‘ í¬ë ˆì•„í‹´ ë ˆë²¨), ejection_fraction(ë°•ì¶œê³„ìˆ˜), ê·¸ë¦¬ê³  ageì´ë‹¤.

- ì‹¤ì œë¡œ ë„ë©”ì¸ ì§€ì‹ê³¼ ë¹„êµë´¤ì„ë•Œ í¬ë ˆì•„í‹´ ë ˆë²¨ì´ë‚˜, ë°•ì¶œê³„ìˆ˜ëŠ” ì‹¬ë¶€ì „ì„ ì¸¡ì •í•˜ëŠ”ë° ì¤‘ìš”í•œ ì§€í‘œì´ë‹¤.

- **ê·¸ëŸ¬ë¯€ë¡œ Classificationì„ ì ìš©í•œ ë°ì´í„° ë¶„ì„ìœ¼ë¡œ ì‹¬ë¶€ì „ì¦ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆìŒì„ í™•ì¸í–ˆë‹¤.**

