---
layout: single
title: '"[DL] CNN의 기본 개념을 알아보자 (2) - CNN의 레이어구조"'
categories:
  - deep_learning
tags:
  - deep-learning
  - DL
  - 딥러닝
toc: true
highlight: false
header:
  teaser: /assets/images/review_article/deep_learing_thumbnail.jpg
  overlay_image: /assets/images/review_article/deep_learing_thumbnail.jpg
  overlay_filter: 0.5
  caption: "Photo credit: [Unsplash](https://unsplash.com/ko/%EC%82%AC%EC%A7%84/XJXWbfSo2f0)"
---

## 🚦 Summary


---

## 📌 Intro.
- 

---

> 💡 이런걸 정리합니다.


---

## Convolution  레이어 구조 살펴보기 (2)
### Max Pooling에 stride를 적용하기
- [풀링 레이어(Pooling Layer)](풀링%20레이어(Pooling%20Layer).md) 의 한 종류로 [맥스 풀링 (Max Pooling)](맥스%20풀링%20(Max%20Pooling).md) 이라는 것이 있습니다.
- 일반적으로 [CNN(Convolution Neural Network)](CNN(Convolution%20Neural%20Network).md) 을 할때 [맥스 풀링 (Max Pooling)](맥스%20풀링%20(Max%20Pooling).md) 은 [스트라이드(Stride)](스트라이드(Stride).md) 와 함께 사용됩니다.
- ![스트라이드(Stride)](스트라이드(Stride).md)
- [🤔 컨볼루션 연산과정](🤔%20컨볼루션%20연산과정.md) 에서는 필터가 한 칸씩 이동하며 연산을 수행하는데, 이는 [스트라이드(Stride)](스트라이드(Stride).md) 값이 1인 경우 입니다.
- 즉 [스트라이드(Stride)](스트라이드(Stride).md) 값을 조정함에 따라 한번에 shift하는 칸의 수를 조절할 수 있습니다. 아래의 이미지는 [스트라이드(Stride)](스트라이드(Stride).md) 값을 2로 한 경우의 [🤔 컨볼루션 연산과정](🤔%20컨볼루션%20연산과정.md) 을 보여줍니다.

![](https://i.imgur.com/xGBFiNP.png)

### Max Pooling과 Stride는 보통 같은 값을 가진다.
- 즉, [맥스 풀링 (Max Pooling)](맥스%20풀링%20(Max%20Pooling).md) 의 값도 무조건 1로 하는 것이 아니라 [스트라이드(Stride)](스트라이드(Stride).md) 의 값 처럼 조정이 가능하다는 겁니다.
- 또한, 서로 다른 값을 각각 지정할 수도 있다는 것입니다.
- 아래 이미지는 [맥스 풀링 (Max Pooling)](맥스%20풀링%20(Max%20Pooling).md) 값은 고정인데 [스트라이드(Stride)](스트라이드(Stride).md) 값이 달라질 때 어떻게 결과가 달라지는 지를 보여 줍니다.

![](https://i.imgur.com/idYaZ8I.png)

- 일반적으로 [맥스 풀링 (Max Pooling)](맥스%20풀링%20(Max%20Pooling).md) 은 [스트라이드(Stride)](스트라이드(Stride).md) 와 같도록 설정합니다.
	- 그 이유는 겹쳐서 풀링하지 않기 위함입니다.
	- 풀링의 크기와 스트라이드의 크기에 따라 결과의 크기가 달라지기 때문입니다.

#### [맥스 풀링 (Max Pooling)](맥스%20풀링%20(Max%20Pooling).md) 와 [스트라이드(Stride)](스트라이드(Stride).md) 로 변경되는 사이즈
- $2 \times 2$ max pooling 을 2 strid로 적용하면 가로와 세로가 각각 절반이 됩니다.
	- 면적으로는 $\frac{1}{4}$  가 됩니다.
- 아래의 샘플 코드로 두 값의 조정에 따른 결과를 도출할 수 있습니다.

```python
import tensorflow as tf
# 1장 x 가로 1920 픽셀 x 세로 1080 픽셀 x 3채널(빨, 초, 파)
pic = tf.zeros((1, 1920, 1080, 3))
print("입력 이미지 데이터:", pic.shape)
print('\n')

conv_layer = tf.keras.layers.Conv2D(filters=16, # 16개 필터
                                    kernel_size=(5, 5),    # 5 x 5 크기
                                    use_bias=False)    # bias에 대해서는 여기서는 설명하지 않습니다.
conv_out = conv_layer(pic)
print("16개 필터 Convolution 결과 데이터:", conv_out.shape)
print('\n')

pool_layer = tf.keras.layers.MaxPool2D(pool_size=(2, 2), strides=(2, 2))
pool_out = pool_layer(conv_out)
print("Pooling 결과 데이터:", pool_out.shape)
```
```
입력 이미지 데이터: (1, 1920, 1080, 3)


16개 필터 Convolution 결과 데이터: (1, 1916, 1076, 16)


Pooling 결과 데이터: (1, 958, 538, 16)
```

- 이는 두 [[하이퍼파라미터(Hyperparameter)]] 가 작동하는 방식에 의해서 결정됩니다.
	- [맥스 풀링 (Max Pooling)](맥스%20풀링%20(Max%20Pooling).md) 은 입력 데이터에 대해 지정된 크기(ex. $2\times 2$) 영역에서 최대값을 선택해 대표값으로 출력하는 역할입니다.
		- 즉 [맥스 풀링 (Max Pooling)](맥스%20풀링%20(Max%20Pooling).md) 의 값이 커질수록 더 넓은 범위에서 최대값을 탐색하고 출력합니다.
	- [스트라이드(Stride)](스트라이드(Stride).md) 는 그 [맥스 풀링 (Max Pooling)](맥스%20풀링%20(Max%20Pooling).md) 이 입력 데이터안에서 한번에 몇칸을 움직일지를 설정합니다.
		- 스트라이드값이 2라면 필터는 가로 & 세로 각각 2칸씩 이동합니다.



## 🎈 Outro.
- 
