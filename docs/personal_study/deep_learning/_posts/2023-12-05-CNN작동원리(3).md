---
layout: single
title: '"[DL] CNN의 기본 개념을 알아보자 (2) - 예제 사례로 보는 CNN(feat. LeNet-5 , Art Style)"'
categories:
  - deep_learning
tags:
  - deep-learning
  - DL
  - 딥러닝
toc: true
highlight: false
header:
  teaser: /assets/images/review_article/deep_learing_thumbnail.jpg
  overlay_image: /assets/images/review_article/deep_learing_thumbnail.jpg
  overlay_filter: 0.5
  caption: "Photo credit: [Unsplash](https://unsplash.com/ko/%EC%82%AC%EC%A7%84/XJXWbfSo2f0)"
---

## 🚦 Summary


---

## 📌 Intro.
- 

---

> 💡 이런걸 정리합니다.


---

### CNN의 이해를 바탕으로 Art Style  논문 분석해보기
![](https://i.imgur.com/lLkNU7b.jpg)

- Art Style은 사진영상을 사전에 학습된 Art 영상의 특징처럼 변환해주는 일종의 Style Transfer 와 관련된 논문입니다.
- 즉 CNN을 이용해 하나의 이미지(콘텐츠 이미지)의 내용은 유지하면서 다른 이미지(스타일 이미지)의 스타일을 적용하는 기술입니다.
- 이 기술은 콘텐츠 이미지와 스타일 이미지를 CNN을 통과시켜 각각의 특징을 추출하고 이를 결합하여 새로운 이미지를 생성합니다.

#### 과정에 대한 설명
1. 스타일 이미지 추출: 스타일 이미지에서는 텍스처, 색상, 브러시 스트로크 등과 같은 예술적 스타일 정보를 추출합니다. 이는 일반적으로 신경망의 초기 층에서 이루어지며, 스타일을 대표하는 특징들이 인코딩됩니다.
    
2. 콘텐츠 이미지 추출: 콘텐츠 이미지에서는 건물의 색상, 경계선 등과 같은 구조적 특징을 추출합니다. 이러한 정보는 신경망의 더 깊은 층에서 추출되며, 이미지의 기본 틀을 형성하는 중요한 정보들입니다.
    
3. 특징 합성: 추출된 스타일 정보를 콘텐츠 이미지의 구조적 특징과 합성하여, 콘텐츠 이미지는 그대로 유지하되 스타일 이미지의 예술적 특성을 입히게 됩니다.
    
4. 결과 생성: 이 과정을 통해 생성된 결과물은 콘텐츠 이미지의 기본 구조는 유지하되, 스타일 이미지의 예술적 스타일이 적용된 새로운 이미지가 됩니다.
    

이 과정은 대개 컨볼루션 신경망(Convolutional Neural Network, CNN)을 사용하여 구현되며, 다양한 계층에서 특징을 추출하고 이를 결합하여 새로운 이미지를 생성합니다. 이미지에서 보여주는 `A1`, `B1`, `C1`등의 부분은 신경망의 각 층을 나타내며, 여기서 `A1 = B1`과 `h(A1) = h(C1)`는 스타일 이미지의 스타일이 콘텐츠 이미지에 성공적으로 전이되었음을 나타냅니다.

#### 계산식을 중심으로한 설명
스타일 전이에서 사용되는 신경망은 대체로 다음의 세 부분으로 나눌 수 있습니다:

1. 콘볼루션 계층(Convolution layer): 이미지에서 콘텐츠와 스타일 특징을 추출하는 역할을 합니다. 여러 필터(filter)를 통과하면서 이미지의 로컬 패턴을 인식합니다. 이 계층은 이미지의 세부적인 텍스처나 형태 등을 파악합니다.
    
2. 풀링 계층(Pooling layer): 콘볼루션 계층에서 추출한 특징들을 요약하고 간소화하는 역할을 합니다. Max Pooling은 주어진 영역에서 가장 높은 값을 선택하여 이미지의 크기를 줄이면서도 중요한 특징을 유지합니다. 이 과정은 네트워크의 과적합을 방지하고, 처리해야 할 특징의 수를 감소시키는 데 도움을 줍니다.
    
3. 전체 신경망(Full network): 콘볼루션과 풀링 계층을 거쳐 추출된 특징들을 기반으로 최종 이미지를 재구성합니다. 이때 콘텐츠 이미지의 구조적 정보와 스타일 이미지의 스타일 정보가 결합됩니다.
    

연산식 $A1 = B1$과 $h(A1) = h(C1)$을 설명하면 다음과 같습니다:

- $A1 = B1$: 여기서 $A1$과 $B1$은 신경망의 특정 계층에서 추출된 스타일 특징을 나타냅니다. $A1$은 원본 스타일 이미지에서, $B1$은 변환된 콘텐츠 이미지에서 추출된 스타일 특징입니다. $A1 = B1$은 변환된 이미지가 원본 스타일 이미지의 스타일 특징을 정확하게 모방했음을 의미합니다.
    
- $h(A1) = h(C1)$: $h$는 신경망을 통해 얻은 특징을 처리하는 함수로, 여기서는 스타일 특징을 콘텐츠 이미지에 적용하는 함수를 의미할 수 있습니다. $h(A1)$ 은 원본 스타일 이미지의 특징을 적용받은 결과이며, $C1$ 은 원본 콘텐츠 이미지에서 추출된 특징입니다. 이 식은 원본 콘텐츠 이미지의 구조적 특징에 스타일 이미지의 스타일을 적용한 결과가 원본 스타일 이미지의 특징과 동일하다는 것을 나타냅니다.
    

이 과정을 통해, 콘텐츠 이미지는 원본의 구조를 유지하면서 스타일 이미지의 예술적 스타일을 갖게 되는 것입니다.

#### 함수 $h$ 에 대한  추가 설명
함수 $h$ 는 주로 신경망의 중간 층의 특징 맵을 분석하여 이미지의 스타일을 캡처합니다. 이것이 가능한 이유는 다음과 같습니다
1. 중간 층의 특성: CNN의 중간 층은 이미지의 질감과 패턴 같은 스타일적 특성을 포착합니다. 이러한 층들은 이미지의 상세한 콘텐츠보다는 질감과 스타일에 더 반응하기 때문입니다.
    
2. 그람 행렬(Gram Matrix): 스타일 정보는 그람 행렬을 통해 수학적으로 표현됩니다. 그람 행렬은 특징 맵의 각 필터 응답 사이의 내적을 계산하여 만듭니다. 이는 필터 응답의 패턴과 구조를 나타내는 통계적인 표현으로, 이미지의 스타일을 나타내는데 사용됩니다.
    
3. 최적화 과정: 스타일 전이에서 원본 이미지에 대해 신경망을 통과시켜 얻은 특징 맵과 목표 스타일 이미지의 그람 행렬을 비교함으로써, 새로운 이미지의 스타일이 목표 스타일과 일치하도록 최적화합니다.
    

함수 $h$를 통해 스타일 정보를 얻는 과정은 다음과 같습니다:

- 특징 추출: CNN을 통해 입력 이미지로부터 특징 맵을 추출합니다.
- 스타일 표현: 중간 층의 특징 맵으로부터 그람 행렬을 계산합니다.
- 스타일 최적화: 원본 콘텐츠 이미지의 특징 맵과 스타일 이미지의 그람 행렬을 비교하며, 이를 최적화 과정을 통해 일치시키도록 합니다.

이 과정을 통해 생성된 새로운 이미지는 원본 이미지의 콘텐츠를 유지하면서 목표 스타일을 반영하게 됩니다. 이러한 기술은 예술적 스타일을 다른 이미지에 적용하고자 할 때 특히 유용합니다.



## 🎈 Outro.
- 
